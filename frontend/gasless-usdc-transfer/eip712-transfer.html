<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EIP-712 Gasless USDC Transfer</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='0.9em' font-size='90'>üîê</text></svg>">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <h1>EIP-712 Gasless USDC Transfer</h1>
        
        <div class="accounts-container">
            <!-- Relayer Account Section -->
            <div class="account-section">
                <h2>Relayer Account</h2>
                <div class="account-subtitle">Default account loaded automatically</div>
                <div id="relayer-input-section" class="input-section">
                    <input type="text" id="relayer-private-key" placeholder="Enter private key (0x...)" class="private-key-input">
                    <div class="button-group">
                        <button id="relayer-import" class="btn btn-primary">Import</button>
                        <button id="relayer-generate" class="btn btn-secondary">Generate</button>
                    </div>
                </div>
                <div id="relayer-display-section" class="display-section hidden">
                    <div class="account-info">
                        <label>Address:</label>
                        <div id="relayer-address" class="address-display"></div>
                        <div class="account-type-indicator">
                            <span class="account-type default">Default Account</span>
                        </div>
                        <div class="account-actions">
                            <button id="relayer-reset" class="btn btn-reset">Reset to Default</button>
                            <button id="relayer-edit" class="btn btn-edit">Edit Account</button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- User Account Section -->
            <div class="account-section">
                <h2>User Account</h2>
                <div class="account-subtitle">Default account loaded automatically</div>
                <div id="user-input-section" class="input-section">
                    <input type="text" id="user-private-key" placeholder="Enter private key (0x...)" class="private-key-input">
                    <div class="button-group">
                        <button id="user-import" class="btn btn-primary">Import</button>
                        <button id="user-generate" class="btn btn-secondary">Generate</button>
                    </div>
                </div>
                <div id="user-display-section" class="display-section hidden">
                    <div class="account-info">
                        <label>Address:</label>
                        <div id="user-address" class="address-display"></div>
                        <label>Private Key:</label>
                        <div id="user-private-key-display" class="private-key-display"></div>
                        <div class="account-type-indicator">
                            <span class="account-type default">Default Account</span>
                        </div>
                        <div class="account-actions">
                            <button id="user-reset" class="btn btn-reset">Reset to Default</button>
                            <button id="user-edit" class="btn btn-edit">Edit Account</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Blockchain Configuration Section -->
        <div class="blockchain-config">
            <h2>Blockchain Configuration</h2>
            <div class="config-grid">
                <div class="config-item">
                    <label for="rpc-url">RPC URL:</label>
                    <div class="url-input-group">
                        <input type="url" id="rpc-url" placeholder="Enter RPC URL" class="url-input">
                        <button id="rpc-reset" class="btn btn-small">Reset to Default</button>
                    </div>
                    <div class="url-display" id="rpc-display">
                        <span class="url-label">Current RPC URL:</span>
                        <span class="url-value" id="rpc-url-value"></span>
                    </div>
                </div>

                <div class="config-item">
                    <label for="explorer-url">Explorer URL:</label>
                    <div class="url-input-group">
                        <input type="url" id="explorer-url" placeholder="Enter Explorer URL" class="url-input">
                        <button id="explorer-reset" class="btn btn-small">Reset to Default</button>
                    </div>
                    <div class="url-display" id="explorer-display">
                        <span class="url-label">Current Explorer URL:</span>
                        <span class="url-value" id="explorer-url-value"></span>
                    </div>
                </div>
            </div>
        </div>

        <!-- USDC Contract Section -->
        <div class="contract-deployment">
            <h2>USDC Contract</h2>
            <div class="deployment-container">
                <div class="contract-info">
                    <h3>ERC20Mintable Contract</h3>
                    <div class="contract-details">
                        <div class="detail-item">
                            <label>Contract Address:</label>
                            <span class="contract-address" id="default-contract-address">0x8A4BC9B8e31bc6B144fD1068581dc0FC2A7885e7</span>
                        </div>
                        <div class="detail-item">
                            <label>Status:</label>
                            <span class="contract-status" id="contract-status">Checking...</span>
                        </div>
                    </div>
                </div>
                
                <div class="deployment-actions">
                    <div class="deployment-form">
                        <div class="form-group">
                            <label for="mint-recipient">Recipient Address:</label>
                            <input type="text" id="mint-recipient" placeholder="Enter recipient address" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="mint-amount">Amount:</label>
                            <input type="number" id="mint-amount" placeholder="Enter amount" min="0" step="1" class="form-input">
                        </div>
                        <button id="mint-tokens" class="btn btn-success" disabled>Mint Tokens</button>
                    </div>
                </div>
            </div>
        </div>

        <!-- EIP-712 Transfer Section -->
        <div class="contract-interactions">
            <h2>EIP-712 Gasless Transfer</h2>
            <div class="interactions-container">
                <!-- EIP-712 Message Section -->
                <div class="interaction-section">
                    <h3>EIP-712 Message Configuration</h3>
                    <div class="interaction-subtitle">
                        Configure the EIP-712 message for signature
                    </div>
                    <div class="interaction-form">
                        <div class="form-group">
                            <label for="domain-name">Domain Name:</label>
                            <input type="text" id="domain-name" placeholder="SimpleDelegateContract" value="SimpleDelegateContract" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="domain-version">Domain Version:</label>
                            <input type="text" id="domain-version" placeholder="1" value="1" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="expiry-time">Expiry (seconds from now):</label>
                            <input type="number" id="expiry-time" placeholder="3600" value="3600" min="1" class="form-input">
                        </div>
                    </div>
                </div>

                <!-- Transfer Configuration Section -->
                <div class="interaction-section">
                    <h3>Transfer Configuration</h3>
                    <div class="interaction-subtitle">
                        Configure the transfer details
                        <span class="balance-display" id="user-token-balance">Tokens (User): Loading...</span>
                        <span class="balance-display" id="relayer-token-balance">Tokens (Relayer): Loading...</span>
                    </div>
                    <div class="interaction-form">
                        <div class="form-group">
                            <label for="transfer-recipient">Recipient Address:</label>
                            <input type="text" id="transfer-recipient" placeholder="Enter recipient address" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="transfer-amount">Amount:</label>
                            <input type="number" id="transfer-amount" placeholder="Enter amount" min="0" step="1" class="form-input">
                        </div>
                        <div class="form-group">
                            <label for="transfer-fee">Fee (to Relayer):</label>
                            <input type="number" id="transfer-fee" placeholder="Enter fee amount" min="0" step="0.001" class="form-input">
                        </div>
                    </div>
                </div>

                <!-- Signature and Execution Section -->
                <div class="interaction-section">
                    <h3>Signature & Execution</h3>
                    <div class="interaction-subtitle">
                        Sign the EIP-712 message and execute the transfer
                    </div>
                    <div class="interaction-form">
                        <div class="form-group">
                            <label>EIP-712 Message Preview:</label>
                            <textarea id="eip712-preview" readonly class="form-textarea" rows="8"></textarea>
                        </div>
                        <div class="button-group">
                            <button id="sign-message" class="btn btn-info" disabled>Sign EIP-712 Message</button>
                            <button id="verify-signature" class="btn btn-secondary" disabled>Verify Signature</button>
                            <button id="execute-transfer" class="btn btn-success" disabled>Execute Transfer</button>
                        </div>
                        <div class="form-group">
                            <label>Signature:</label>
                            <textarea id="signature-output" readonly class="form-textarea" rows="3" placeholder="Signature will appear here after signing"></textarea>
                        </div>
                        <div class="form-group">
                            <label>Verification Result:</label>
                            <div id="verification-result" class="verification-display"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script src="ethers-6.15.0.umd.min.js" type="application/javascript"></script>
    <script src="eip712-transfer.js"></script>
</body>
</html>
